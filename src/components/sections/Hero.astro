---
import { basics } from "@cv";
import Section from "@/components/Section.astro";
import Mail from "@/icons/Mail.astro";
import X from "@/icons/X.astro";
import LinkedIn from "@/icons/LinkedIn.astro";
import GitHub from "@/icons/GitHub.astro";
import WorldMap from "@/icons/WorldMap.astro";
import Blog from "@/icons/Blog.astro";
import type { SocialIcon } from "@/types";

const { name, label, image, imageAlt, location, profiles, email } = basics;
const { city, region } = location;

const SOCIAL_ICONS: SocialIcon = {
  GitHub,
  LinkedIn,
  X,
};

const linkedInfo = profiles.find(({ network }) => network === "LinkedIn");
const linkedUrl = linkedInfo?.url;

const printInfo = [email, linkedUrl].filter(Boolean).join(" • ");
---

<!-- Sin título aquí porque Hero suele tener su propio H1 -->
<div class="bg-gradient-to-r from-white to-gray-100 dark:from-dark dark:to-dark-card dark:bg-none shadow-sm pt-28 md:pt-20">
  <Section>
    <div class="flex flex-row items-center justify-between gap-8 py-4 md:py-6 lg:py-8">
      <div class="flex flex-col gap-5 pr-8 md:gap-6">
        <!-- Nombre como H1 para SEO -->
        <h1 class="text-4xl font-bold text-secondary-dark dark:text-white md:text-5xl lg:text-6xl">
          {name}
        </h1>
        <!-- Titular (puesto o especialidad) como H2 -->
        <h2 class="text-xl text-secondary dark:text-gray-300 max-w-[90%] font-medium md:text-2xl">
          {label}
        </h2>

        <!-- Localización -->
        <span class="flex items-center gap-2 text-gray-700 dark:text-gray-400">
          <WorldMap />
          {city}, {region}
        </span>

        <!-- Información en versión de impresión -->
        <div class="print text-gray-700 dark:text-gray-400">
          {printInfo}
        </div>

        <!-- Enlaces a redes sociales y correo -->
        <nav class="no-print mt-2 md:mt-4 flex flex-wrap gap-4" aria-label="Redes sociales y contacto">
          {
            email && (
              <a
                href={`mailto:${email}`}
                title={`Enviar un correo a ${email}`}
                aria-label={`Enviar un correo a ${name} (${email})`}
                target="_blank"
                rel="noopener noreferrer"
                class="flex h-11 w-11 items-center justify-center rounded-full border border-gray-200 dark:border-gray-700 bg-white dark:bg-dark-card transition-all hover:bg-primary hover:text-white hover:shadow-md focus:outline-primary focus:outline-offset-2 hover:no-underline"
              >
                <Mail />
              </a>
            )
          }
          {
            profiles.map(({ network, url }) => {
              const Icon = SOCIAL_ICONS[network];
              return (
                <a
                  href={url}
                  title={`Visitar el perfil de ${name} en ${network}`}
                  aria-label={`Visitar el perfil de ${name} en ${network}`}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="flex h-11 w-11 items-center justify-center rounded-full border border-gray-200 dark:border-gray-700 bg-white dark:bg-dark-card transition-all hover:bg-primary hover:text-white hover:shadow-md focus:outline-primary focus:outline-offset-2 hover:no-underline"
                >
                  <Icon />
                </a>
              );
            })
          }
          <!-- Enlace al blog -->
          <a
            href="https://blog.sergiomarquez.dev"
            class="flex h-11 w-11 items-center justify-center rounded-full border border-gray-200 dark:border-gray-700 bg-green-50 dark:bg-green-800 text-gray-800 dark:text-white transition-all hover:bg-green-500 hover:text-white hover:shadow-md focus:outline-primary focus:outline-offset-2 hover:no-underline"
            title="Visitar mi blog"
            target="_blank"
            rel="noopener noreferrer"
          >
            <Blog />
          </a>
        </nav>
      </div>
      <figure class="relative">
        <div class="absolute inset-0 bg-primary/10 dark:bg-primary/20 rounded-full -m-2 blur-md"></div>
        <img
          src={image}
          alt={imageAlt}
          width="180"
          height="180"
          class="relative aspect-square w-40 rounded-full object-cover shadow-md border-4 border-white dark:border-gray-800 md:w-[180px]"
        />
      </figure>
    </div>
  </Section>
</div>

<style>
  @media (max-width: 700px) {
    div {
      flex-direction: column-reverse;
      padding: 16px;
    }

    div > div {
      justify-content: center;
      align-items: center;
      padding-right: 0;
      text-align: center;
      margin-top: 1.5rem;
    }

    figure {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 0.5rem;
      margin-top: 2rem;
    }

    h1 {
      font-size: 2.5rem;
    }

    h2 {
      max-width: 100%;
      font-size: 1.2rem;
    }

    img {
      width: 140px;
    }

    .flex-col {
      gap: 8px !important;
    }

    nav {
      margin-top: 0.75rem !important;
      justify-content: center;
    }
  }
</style>
