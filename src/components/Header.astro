---
import { basics } from "@cv";
import ThemeToggle from "./ThemeToggle.astro";
import CodeEffectToggle from "./CodeEffectToggle.astro";
const { name } = basics;

// Enlaces de navegación
const navLinks = [
  { href: "#sobre-mi", label: "Sobre mí" },
  { href: "#experiencia", label: "Experiencia" },
  { href: "#proyectos", label: "Proyectos" },
  { href: "#habilidades", label: "Habilidades" },
  { href: "#certificados", label: "Certificados" },
  { href: "#educacion", label: "Educación" },
  { href: "#contacto", label: "Contacto" }
];
---

<header class="sticky top-0 z-50 bg-white dark:bg-dark-card shadow-sm py-3 px-4 transition-all duration-300">
  <div class="max-w-4xl mx-auto flex justify-between items-center">
    <!-- Logo/Nombre -->
    <a href="#" class="text-lg font-bold text-primary hover:no-underline">
      {name}
    </a>

    <!-- Navegación para pantallas medianas y grandes -->
    <nav class="hidden md:flex items-center">
      <ul class="flex space-x-6 mr-4">
        {navLinks.map(({ href, label }, index) => (
          <li>
            <a
              href={href}
              class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary text-sm font-medium transition-colors duration-300 hover:no-underline"
            >
              {label}
            </a>
          </li>
        ))}
      </ul>

      <div class="flex items-center space-x-2">
        <!-- Botón de efecto de código -->
        <CodeEffectToggle />

        <!-- Botón de cambio de tema -->
        <ThemeToggle />
      </div>
    </nav>

    <!-- Contenedor para móvil: botón de menú y botón de tema -->
    <div class="md:hidden flex items-center space-x-2">
      <!-- Botón de efecto de código -->
      <CodeEffectToggle />

      <!-- Botón de cambio de tema -->
      <ThemeToggle />

      <!-- Botón de menú móvil -->
      <button
        id="mobile-menu-button"
        class="text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary"
        aria-label="Abrir menú de navegación"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Menú móvil (oculto por defecto) -->
  <div id="mobile-menu" class="hidden md:hidden mt-4 pb-2">
    <nav>
      <ul class="flex flex-col space-y-3">
        {navLinks.map(({ href, label }) => (
          <li>
            <a
              href={href}
              class="block text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary text-sm font-medium transition-colors duration-300 hover:no-underline px-4 py-2"
            >
              {label}
            </a>
          </li>
        ))}
      </ul>
    </nav>
  </div>
</header>

<script>
  // Lógica para el menú móvil
  document.addEventListener('DOMContentLoaded', () => {
    // Toggle menú móvil
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');

    if (mobileMenuButton && mobileMenu) {
      mobileMenuButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });

      // Cerrar menú al hacer clic en un enlace
      const mobileLinks = mobileMenu.querySelectorAll('a');
      mobileLinks.forEach(link => {
        link.addEventListener('click', () => {
          mobileMenu.classList.add('hidden');
        });
      });
    }

    // Cambiar estilo del header al hacer scroll
    const header = document.querySelector('header');
    if (header) {
      window.addEventListener('scroll', () => {
        if (window.scrollY > 50) {
          header.classList.add('py-2', 'shadow-md');
          header.classList.remove('py-3', 'shadow-sm');
        } else {
          header.classList.add('py-3', 'shadow-sm');
          header.classList.remove('py-2', 'shadow-md');
        }
      });
    }
  });
</script>

<style>
  /* Animación suave para el header */
  header {
    backdrop-filter: blur(10px);
    background-color: rgba(255, 255, 255, 0.95);
  }

  /* Estilo para el header en modo oscuro */
  :global(.dark) header {
    background-color: rgba(30, 30, 30, 0.95);
  }

  /* Estilo para el enlace activo */
  header nav a.active {
    color: var(--color-primary);
    font-weight: 600;
  }
</style>
